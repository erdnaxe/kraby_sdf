<?xml version="1.0" ?>
{%- from 'links/box.sdf.j2' import box %}
{%- from 'links/endcap.sdf.j2' import endcap %}
{%- from 'links/foot.sdf.j2' import foot %}
{%- from 'links/joint.sdf.j2' import joint %}
{%- from 'links/servomotor.sdf.j2' import servomotor %}
{%- from 'joints/joint_fixed.sdf.j2' import joint_fixed %}
{%- from 'joints/joint_servomotor.sdf.j2' import joint_servomotor %}

<!--
TODO: joint motorized
TODO: joint limits
-->
<sdf version="1.6">
  <world name="default">
    <gravity>0 0 -9.81</gravity>

    <model name="hexapod">
      {{- box('0 0 .203 0 0 0') }}

      <!-- Leg 1 -->
      {{- servomotor('servomotor_1', '.066695 -0.063697 0.2041193 0 0 -0.78539') }}
      {{- joint('joint_1', '0.091561 -0.073562 0.2041193 0.0 0.0 -0.78539') }}
      {{- servomotor('servomotor_2', '0.114846208538 -0.0958851709964 0.1961644 1.57079 -0.7854 -0.78539') }}
      {{- servomotor('servomotor_3', '0.139887890732 -0.120708657232 0.161527 1.57079 2.3561945 -0.78539') }}
      {{- foot('foot_1', '0.144735157965 -0.126863982193 0.1226097 0.0 0.0 -0.78539') }}
      {{- endcap('endcap_1', '0.145054064677 -0.127054191313 0.07309 0.0 0.0 -0.78539') }}
      {{- joint_servomotor('servomotor_1', 'joint_1', '-0.0245 0.0 0.0 0.0 0.0 0.0', '0.0 0.0 1.0') }}
      {{- joint_servomotor('joint_1', 'servomotor_2', '0.0 0.011 0.0 0.0 0.0 0.0', '0.0 0.0 1.0') }}
      {{- joint_fixed('servomotor_2', 'servomotor_3') }}
      {{- joint_servomotor('servomotor_3', 'foot_1', '0.0 0.0 0.031 0.0 0.0 0.0', '0.0 1.0 0.0') }}
      {{- joint_fixed('foot_1', 'endcap_1') }}

      <!-- Leg 2 -->
      {{- servomotor('servomotor_4', '0.092225 0 0.2041193 0 0 0') }}
      {{- joint('joint_2', '0.116784 0.010607 0.2041193 0.0 0.0 0.0') }}
      {{- servomotor('servomotor_5', '0.149034 0.011287 0.1961644 1.57079 -0.7854 0.0') }}
      {{- servomotor('servomotor_6', '0.184294 0.011441 0.161527 1.57079 2.3561945 0.0') }}
      {{- foot('foot_2', '0.192074 0.010516 0.1226097 0.0 0.0 0.0') }}
      {{- endcap('endcap_2', '0.192434 0.010607 0.07309 0.0 0.0 0.0') }}
      {{- joint_servomotor('servomotor_4', 'joint_2', '-0.0245 0.0 0.0 0.0 0.0 0.0', '0.0 0.0 1.0') }}
      {{- joint_servomotor('joint_2', 'servomotor_5', '0.0 0.011 0.0 0.0 0.0 0.0', '0.0 0.0 1.0') }}
      {{- joint_fixed('servomotor_5', 'servomotor_6') }}
      {{- joint_servomotor('servomotor_6', 'foot_2', '0.0 0.0 0.031 0.0 0.0 0.0', '0.0 1.0 0.0') }}
      {{- joint_fixed('foot_2', 'endcap_2') }}

      <!-- Leg 3 -->
      {{- servomotor('servomotor_7', '.066695 0.063697 0.2041193 0 0 0.78539') }}
      {{- joint('joint_3', '0.076561 0.088562 0.2041193 0.0 0.0 0.78539') }}
      {{- servomotor('servomotor_8', '0.0988845511662 0.111846844069 0.1961644 1.57079 -0.7854 0.78539') }}
      {{- servomotor('servomotor_9', '0.123708446249 0.136888120972 0.161527 1.57079 2.3561945 0.78539') }}
      {{- foot('foot_3', '0.129863850349 0.141735287708 0.1226097 0.0 0.0 0.78539') }}
      {{- endcap('endcap_3', '0.130054064677 0.142054191313 0.07309 0.0 0.0 0.78539') }}
      {{- joint_servomotor('servomotor_7', 'joint_3', '-0.0245 0.0 0.0 0.0 0.0 0.0', '0.0 0.0 1.0') }}
      {{- joint_servomotor('joint_3', 'servomotor_8', '0.0 0.011 0.0 0.0 0.0 0.0', '0.0 0.0 1.0') }}
      {{- joint_fixed('servomotor_8', 'servomotor_9') }}
      {{- joint_servomotor('servomotor_9', 'foot_3', '0.0 0.0 0.031 0.0 0.0 0.0', '0.0 1.0 0.0') }}
      {{- joint_fixed('foot_3', 'endcap_3') }}

      <!-- Leg 4 -->
      {{- servomotor('servomotor_10', '-0.066695 0.063697 0.2041193 0 0 -0.78539') }}
      {{- joint('joint_4', '-0.076561 0.088562 0.2041193 0.0 0.0 2.35617') }}
      {{- servomotor('servomotor_11', '-0.0998454795941 0.11088593133 0.1961644 1.57079 -0.7854 2.35617') }}
      {{- servomotor('servomotor_12', '-0.124886351199 0.135710235254 0.161527 1.57079 2.3561945 2.35617') }}
      {{- foot('foot_4', '-0.129733417436 0.141865718491 0.1226097 0.0 0.0 2.35617') }}
      {{- endcap('endcap_4', '-0.130052317936 0.142055938025 0.07309 0.0 0.0 2.35617') }}
      {{- joint_servomotor('servomotor_10', 'joint_4', '-0.0245 0.0 0.0 0.0 0.0 0.0', '0.0 0.0 1.0') }}
      {{- joint_servomotor('joint_4', 'servomotor_11', '0.0 0.011 0.0 0.0 0.0 0.0', '0.0 0.0 1.0') }}
      {{- joint_fixed('servomotor_11', 'servomotor_12') }}
      {{- joint_servomotor('servomotor_12', 'foot_4', '0.0 0.0 0.031 0.0 0.0 0.0', '0.0 1.0 0.0') }}
      {{- joint_fixed('foot_4', 'endcap_4') }}

      <!-- Leg 5 -->
      {{- servomotor('servomotor_13', '-0.092225 0 0.2041193 0 0 0') }}
      {{- joint('joint_5', '-0.116784 0.010607 0.2041193 0.0 0.0 3.14156') }}
      {{- servomotor('servomotor_14', '-0.149034022187 0.00992805307863 0.1961644 1.57079 -0.7854 3.14156') }}
      {{- servomotor('servomotor_15', '-0.184294027197 0.00977520444429 0.161527 1.57079 2.3561945 3.14156') }}
      {{- foot('foot_5', '-0.192073996988 0.0107004584887 0.1226097 0.0 0.0 3.14156') }}
      {{- endcap('endcap_5', '-0.19243399996 0.0106094702441 0.07309 0.0 0.0 3.14156') }}
      {{- joint_servomotor('servomotor_13', 'joint_5', '-0.0245 0.0 0.0 0.0 0.0 0.0', '0.0 0.0 1.0') }}
      {{- joint_servomotor('joint_5', 'servomotor_14', '-0.116784 0.021607 0.2041193 0.0 0.0 3.14156', '0.0 0.0 1.0') }}
      {{- joint_fixed('servomotor_14', 'servomotor_15') }}
      {{- joint_servomotor('servomotor_15', 'foot_5', '0.0 0.0 0.031 0.0 0.0 0.0', '0.0 1.0 0.0') }}
      {{- joint_fixed('foot_5', 'endcap_5') }}

      <!-- Leg 6 -->
      {{- servomotor('servomotor_16', '-0.066695 -0.063697 0.2041193 0 0 0.78539') }}
      {{- joint('joint_6', '-0.091561 -0.073562 0.2041193 0.0 0.0 3.92695') }}
      {{- servomotor('servomotor_17', '-0.113885311488 -0.0968461151127 0.1961644 1.57079 -0.7854 3.92695') }}
      {{- servomotor('servomotor_18', '-0.138710024245 -0.121886581413 0.161527 1.57079 2.3561945 3.92695') }}
      {{- foot('foot_6', '-0.144865586619 -0.12673354715 0.1226097 0.0 0.0 3.92695') }}
      {{- endcap('endcap_6', '-0.14505581136 -0.127052444544 0.07309 0.0 0.0 3.92695') }}
      {{- joint_servomotor('servomotor_16', 'joint_6', '-0.0245 0.0 0.0 0.0 0.0 0.0', '0.0 0.0 1.0') }}
      {{- joint_servomotor('joint_6', 'servomotor_17', '0.0 0.011 0.0 0.0 0.0 0.0', '0.0 0.0 1.0') }}
      {{- joint_fixed('servomotor_17', 'servomotor_18') }}
      {{- joint_servomotor('servomotor_18', 'foot_6', '0.0 0.0 0.031 0.0 0.0 0.0', '0.0 1.0 0.0') }}
      {{- joint_fixed('foot_6', 'endcap_6') }}

      <!-- Box - legs -->
      {{- joint_fixed('box', 'servomotor_1') }}
      {{- joint_fixed('box', 'servomotor_4') }}
      {{- joint_fixed('box', 'servomotor_7') }}
      {{- joint_fixed('box', 'servomotor_10') }}
      {{- joint_fixed('box', 'servomotor_13') }}
      {{- joint_fixed('box', 'servomotor_16') }}
    </model>

    <physics type="bullet">
      <max_step_size>0.001</max_step_size>
      <bullet>
        <solver>
          <type>sequential_impulse</type>
          <min_step_size>0.0001</min_step_size>
          <iters>50</iters>
          <sor>1.3</sor>
        </solver>
        <constraints>
          <cfm>0</cfm>
          <erp>0.2</erp>
          <contact_surface_layer>0.001</contact_surface_layer>
          <split_impulse>1</split_impulse>
          <split_impulse_penetration_threshold>-0.01</split_impulse_penetration_threshold>
        </constraints>
      </bullet>
    </physics>
  </world>
</sdf>

